#!/usr/bin/env python
# encoding: utf-8
import os

from .url import parse_url
from .utils import import_string


def discover(driver="std", uri=None, *args, **kwargs):
    discovery_uri = uri or os.environ.get('SERVICE_DISCOVERY_URI')
    if discovery_uri:
        host, port = parse_url(discovery_uri)
    else:
        host, port = '127.0.0.1', 8500
    driver = "std"
    Diplomat = import_string("diplomat.{0}.Diplomat".format(driver))
    return Diplomat(host, port, *args, **kwargs)
